---
- name: Create folder for github projects
  file: "path={{github_path}} state=directory"

- name: Clone direnv
  git: "repo=https://github.com/zimbatm/direnv dest={{github_path}}/direnv accept_hostkey=yes"
  sudo: no  

- name: Build direnv
  shell: "go build -o direnv chdir={{github_path}}/direnv creates={{github_path}}/direnv/direnv"
  sudo: no
  environment: go_environment

- name: Copy direnv binary to /usr/local/bin
  shell: "cp {{github_path}}/direnv/direnv /usr/local/bin/direnv creates=/usr/local/bin/direnv"
  sudo: yes

- file: path=/usr/local/bin/direnv mode=755
  sudo: yes

- shell: echo 'eval "$(direnv hook bash)"' >> /home/{{ansible_ssh_user}}/.bashrc
